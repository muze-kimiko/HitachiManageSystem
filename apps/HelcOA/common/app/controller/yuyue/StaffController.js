/*
 * File: app/controller/StaffController.js
 *
 * This file was generated by Sencha Architect version 3.2.0.
 * http://www.sencha.com/products/architect/
 *
 * This file requires use of the Sencha Touch 2.4.x library, under independent license.
 * License of Sencha Architect does not include license for Sencha Touch 2.4.x. For more
 * details see http://www.sencha.com/license or contact license@sencha.com.
 *
 * This file will be auto-generated each and everytime you save your project.
 *
 * Do NOT hand edit this file.
 */

Ext.define('HelcOA.controller.yuyue.StaffController', {
    extend: 'HelcOA.controller.ApplicationController',

    config: {
        control: {
//            "panel#mypanel1": {
//                show: 'onMypanel1Show'
//            },
            "list#Home_Unconfirmed_lsit": {
                itemtap: 'onHome_Unconfirmed_lsitItemTap'
            },
            "list#Home_Confirmed_lsit": {
                itemtap: 'onHome_Confirmed_lsitItemTap'
            },
            "button#Booking1_return_btn": {
                tap: 'onBooking1_return_btnTap'
            },
            "button#Booking2_return_btn": {
                tap: 'onBooking2_return_btnTap'
            },"button#yuyueback":{
            	tap:'yuyueback'
            },"button#jdbutton":{
            	tap:'jdbutton'
            },"button#tdbutton":{
            	tap:'tdbutton'
            },"button#startjd":{
            	tap:'jdhb'
            },"button#endjd":{
            	tap:'jdhb'
            },"button#tjhb":{
            	tap:'jdhb'
            }
        }
    },

//    onMypanel1Show: function(component, eOpts) {
//        //我未确认－数据显示
////        Ext.getCmp('Home_Unconfirmed_lsit').getStore().loadDat(
////            function() {},
////            function() {},
////            function() {}
////        );
////        //我已确认－数据显示
////        Ext.getCmp('Home_Confirmed_lsit').getStore().loadDat(
////            function() {},
////            function() {},
////            function() {}
////        );
//
//    },

    onHome_Unconfirmed_lsitItemTap: function(dataview, index, target, record, e, eOpts) {
        this.NextView("Booking1","HelcOA.view.yuyue.Booking1");
        var sj=['title','company','date','address','rs','yijian','peo1','sex1','job1','peo2','sex2','job2','peo3','sex3','job3','FileNo','type','ccdate','cacceptman','yylx'];
		for(var i=0;i<sj.length;i++){
			Ext.getCmp(sj[i]).setValue(record.get(sj[i]));
		}  
	    var type=Ext.getCmp('type').getValue();
	    var yylx=Ext.getCmp('yylx').getValue();
	    var tab=Ext.getCmp('yytab').getTabBar().getInnerItems();
	    
	    var ycy=['company','cacceptman','date'];
	    if(type!='jdr'&&yylx=='公务'){
	    	tab[1].setHidden(true);
	    	for(var i=0;i<ycy.length;i++){
	    		Ext.getCmp(ycy[i]).setHidden(true);
	    	}
	    	
	    }
		//alert("ss"+Ext.getCmp("type").getValue());
    	
    },

    onHome_Confirmed_lsitItemTap: function(dataview, index, target, record, e, eOpts) {
    	this.NextView("Booking2","HelcOA.view.yuyue.Booking2");
    	var sj=['title','company','date','address','rs','yijian','peo1','sex1','job1','peo2','sex2','job2','peo3','sex3','job3','FileNo','type','ccdate','cacceptman','yylx'];
		for(var i=0;i<sj.length;i++){
			Ext.getCmp(sj[i]).setValue(record.get(sj[i]));
		} 
		//alert("ss"+Ext.getCmp("type").getValue());
		var tab=Ext.getCmp('yytabq').getTabBar().getInnerItems();
		var type=Ext.getCmp("type").getValue();
		var yylx=Ext.getCmp('yylx').getValue();
		var ycy=['company','cacceptman','date'];
		if(type=="jdr"){
			Ext.getCmp('startdate').setValue(record.get('date'));
			Ext.getCMP('xgfy').setHidden(true);
		}else{
			Ext.getCmp('startdate').setValue(record.get('ccdate'));
			if(yylx=='公务'){
			tab[2].setHidden(true);
			for(var i=0;i<ycy.length;i++){
	    		Ext.getCmp(ycy[i]).setHidden(true);
	    	}
			}
		}
		
		
//		if(record.get("ststime")==""||record.get("ststime")==null)
//		{
//			Ext.getCmp("enddate").disable();
//			Ext.getCmp("hbsj").disable();
//			Ext.getCmp("endjd").hide();
//		    Ext.getCmp("tjhb").hide();
//		 }else{
//			 Ext.getCmp("startdate").setValue(record.get("ststime"));
//			 Ext.getCmp("startdate").disable();
//			 Ext.getCmp("startjd").hide();
//		 }
//        if(record.get("edtime")==""||record.get("edtime")==null)
//        	 {
//        	 Ext.getCmp("hbsj").disable();
//        	 Ext.getCmp("tjhb").hide();
//        	 }
//        else{
//        	 Ext.getCmp("enddate").setValue(record.get("edtime"));
//        	 Ext.getCmp("enddate").disable();
//			 Ext.getCmp("endjd").hide();
//        }
//		if(record.get("jdqk")!=""&&record.get("jdqk")!=null)
//			{
//			 Ext.getCmp("hbsj").setValue(record.get("jdqk"));
//			 Ext.getCmp("hbsj").disable();
//			 Ext.getCmp("tjhb").hide();
//			}
			
		
		
    },

    onBooking1_return_btnTap: function(button, e, eOpts) {
//        viewUtil.goLast();
    	this.showBackView('yuyuehome','HelcOA.view.yuyue.Homes');
    	
    },

    onBooking2_return_btnTap: function(button, e, eOpts) {
//        viewUtil.goLast();
    	this.showBackView('yuyuehome','HelcOA.view.yuyue.Homes');
    },
    yuyueback:function(){
    	this.showBackView('Menus_id','HelcOA.view.Menus');
    },
    jdbutton:function(){
    	obj=this;
    	var getResult=function(result){
    		
    		if(result==null)
        		return;
    		result=eval("("+result.YYJDReturn.CDATA+")");
    		
    		if(result.stauts=="ok")
    		{Ext.Msg.alert("提交成功！");
    		obj.showBackView('Menus_id','HelcOA.view.Menus');}
    		else
    			{Ext.Msg.alert("提交失败！");
    			return;
    			}
    	};
    	var fileno=Ext.getCmp("FileNo").getValue();
    	var yytype=Ext.getCmp("type").getValue();
    	var flag=null;
    	if(yytype=="jdr")
    	    flag="jdrqr";
    	else if(yytype=="sj")
    		flag="sjqr";
    	else if(yytype=="sj1")
    		flag="sjqr1";
    	else
    		return;
    	var data="";
    	var params = {};
		params.adpName = 'HttpAdapter_OA';
		params.prodNmae = 'yuyuejd';
		params.prmName = [fileno,flag,data];
		obj.connectServerComm(getResult, params);
    },
    tdbutton:function(){
    	obj=this;
    	
    	var fileno=Ext.getCmp("FileNo").getValue();
    	var yytype=Ext.getCmp("type").getValue();
    	var flag=null;
    	if(yytype=="jdr")
    	    flag="jdrtd";
    	else if(yytype=="sj")
    		flag="sjtd";
    	else if(yytype=="sj1")
    		flag="sjtd1";
    	else
    		return;
    	var data=Ext.getCmp("tdyy").getValue();
    	var params = {};
		params.adpName = 'HttpAdapter_OA';
		params.prodNmae = 'yuyuejd';
		params.prmName = [fileno,flag,data];
		var getResult=function(result){
    		if(result==null)
        		return;
    		result=eval("("+result.YYJDReturn.CDATA+")");
    		if(result.stauts=="ok")
    		{Ext.Msg.alert("提交成功！");
    		obj.showBackView('Menus_id','HelcOA.view.Menus');
    		var getResult1=function(result){
    			result=eval("("+result.ttmsgReturn.CDATA+")");
    			console.log(result.result);
    		}
    		var params1={};
    		params1.adpName = 'HttpAdapter_OA';
    		params1.prodNmae = 'ttmsg';
    		params1.prmName = [fileno,flag];
    		obj.connectServerComm(getResult1, params1);
    		}
    		else
    			{Ext.Msg.alert("提交失败！");
    			return;
    			}
    	};
		obj.connectServerComm(getResult, params);
    },
    jdhb:function(){
    	obj=this;
    	var getResult=function(result){
    		
    		if(result==null)
        		return;
    		result=eval("("+result.YYJDReturn.CDATA+")");
    		console.log(result.stauts);
    		if(result.stauts=="ok")
    		{Ext.Msg.alert("提交成功！");
    		obj.showBackView('Menus_id','HelcOA.view.Menus');}
    		else
    			{Ext.Msg.alert("提交失败！");
    			return;
    			}
    	};
    	var fileno=Ext.getCmp("FileNo").getValue();
    	var yytype=Ext.getCmp("type").getValue();
    	var flag=null;
    	if(yytype=="jdr")
    	    flag="jdrst";
    	else if(yytype=="sj")
    		flag="sjst";
    	else if(yytype=="sj1")
    		flag="sjst1";
    	else
    		return;
    	//var st=Ext.getCmp("startdate").getValue();
    	var endt=Ext.getCmp("enddate").getValue();
    	var hbsj=Ext.getCmp("hbsj").getValue();
//    	var data=st+"*"+endt+"*"+hbsj;
    	var data=endt+"*"+hbsj+"*"+Ext.getCmp('lcsq').getValue()+"*"+Ext.getCmp('lcsj').getValue()+"*"+Ext.getCmp('oil').getValue()+"*"+Ext.getCmp('road').getValue()+"*"+Ext.getCmp('parking').getValue();
    	var params = {};
		params.adpName = 'HttpAdapter_OA';
		params.prodNmae = 'yuyuejd';
		params.prmName = [fileno,flag,data];
		obj.connectServerComm(getResult, params);
    }

});

