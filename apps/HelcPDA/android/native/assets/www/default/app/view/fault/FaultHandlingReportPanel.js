
/* JavaScript content from app/view/fault/FaultHandlingReportPanel.js in folder common */
/*
 * File: app/view/FaultHandlingReportPanel.js
 *
 * This file was generated by Sencha Architect version 3.0.3.
 * http://www.sencha.com/products/architect/
 *
 * This file requires use of the Sencha Touch 2.3.x library, under independent license.
 * License of Sencha Architect does not include license for Sencha Touch 2.3.x. For more
 * details see http://www.sencha.com/license or contact license@sencha.com.
 *
 * This file will be auto-generated each and everytime you save your project.
 *
 * Do NOT hand edit this file.
 */

Ext.define('HelcPDA.view.fault.FaultHandlingReportPanel', {
    extend: 'Ext.Panel',
    id:'faultHandlingReportPanel',
    requires: [
        'Ext.Toolbar',
        'Ext.Button',
        'Ext.Spacer',
        'Ext.Label',
        'Ext.form.Panel',
        'Ext.form.FieldSet',
        'Ext.field.Search',
        'Ext.field.DatePicker',
        'Ext.picker.Date'
    ],

    config: {
        layout: 'vbox',
        items: [
            {
                xtype: 'toolbar',
                docked: 'top',
                items: [
                    {
                        xtype: 'button',
                        ui: 'back',
                        text: '返回',
                        id:'backtoFault'
                    },
                    {
                        xtype: 'spacer'
                    },
                    {
                        xtype: 'label',
                        html: '故障报告书'
                    },
                    {
                        xtype: 'spacer'
                    },
                    {
                        xtype: 'button',
                        handler: function(button, e) {
                        	  var menu = Ext.create('Ext.Menu', {
                                  items: [
                                  {
                                      text: '故障原因',
                                      id: 'Why',
                                  },
                                  {
                                      text: 'TCD码',
                                      id: 'TCD',
                                  },
                                  {
                                      text: '配件',
                                      id: 'Accessories',
                                  },
                                  {
                                      text: '作业人员',
                                      id: 'worker',

                                  }, 
                                  {
                                      text: '生成报告书',
                                      id: 'btn_fault_report'
                                  },
//                                  {
//                                      text: '更新报告书',
//                                      id: 'btn_update_report'
//                                  }

                                  ]
                              });


                            Ext.Viewport.setMenu(menu, {
                                side: 'right',
                                reveal: false
                            });

                            Ext.Viewport.showMenu('right');

                        },
                        itemId: 'mybutton6',
                        iconCls: '',
                        text: '更多'
                    }
                ]
            },
            {
                xtype: 'formpanel',
                flex: 1,
                height: '100%',
                items: [
                    {
                        xtype: 'fieldset',
                        title: '故障活动基础信息',
                        items: [
                            {
                                xtype: 'textfield',
                                label: '请求编号',
                                id:'SR_Number',
                                labelWidth: '40%',
                                placeHolder: '请输入服务请求编号',
                                readOnly: true
                            },{
                            	xtype:'hiddenfield',
                            	id:'IS_SAVE',
                            	value:''
                            }
//                            {
//                                xtype: 'textfield',
//                                label: '活动编号',
//                                id:'ACTIVITY_ID',
//                                labelWidth: '40%',
//                                placeHolder: '请输入活动编号',
//                                readOnly: true
//                            }
                        ]
                    },
                    {
                        xtype: 'fieldset',
                        title: '故障工号信息',
                        items: [
                            {
                                xtype: 'panel',
                                layout: 'hbox',
                                items: [
                                    {
                                        xtype: 'searchfield',
                                        height: 40,
                                        width: '90%',
                                        label: '故障工号',
                                        id:'ASSET_NUM',
                                        labelWidth: '42%',
                                        name: '',
                                        placeHolder: '请输入搜索关键字',
                                        required:true,
                                    },
                                    {
                                        xtype: 'button',
                                        height: 41,
                                        style: 'border:0;',
                                        width: '10%',
                                        iconCls: 'search',
                                        id:'search_Asset',
                                        text: ''
                                    },
                                    {
                                    	xtype:'hiddenfield',
                                    	id:'ASSET_NUM_HIDDEN',
                                    	value:'No',
                                    }
                                ]
                            },
                            {
                                xtype: 'textfield',
                                label: '',
                                id:'FOR_ASSET_NUM',
                                labelWidth: '40%',
                                hidden:true,
                                value: [
                                   
                                ],
                                readOnly: true
                            },
                            {
                                xtype: 'textfield',
                                label: '工号地址',
                                id:'Action_Asset_Address',
                                labelWidth: '40%',
                                placeHolder: '请输入工号地址',
                                readOnly: false,
                                required:true,
                            },
                            {
                                xtype: 'textfield',
                                label: '工号地盘',
                                id:'Action_Asset_Domain',
                                labelWidth: '40%',
                                placeHolder: '请输入工号地盘',
                                readOnly: false,
                                required:true,
                            },
                            {
                                xtype: 'textfield',
                                label: '工作大楼',
                                id:'Action_Asset_Edifice',
                                labelWidth: '40%',
                                placeHolder: '请输入工作大楼',
                                readOnly: false,
                                required:true,
                            },
                            {
                                xtype: 'textfield',
                                label: '梯号',
                                id:'Action_Elevator_Mark',
                                labelWidth: '40%',
                                placeHolder: '请输入梯号',
                                readOnly: false,
                                required:true,
                            },
                            {
                                xtype: 'textfield',
                                label: '故障楼层',
                                id:'Action_Elevator_floor',
                                labelWidth: '40%',
                                placeHolder: '请输入故障楼层',
                                readOnly: false
                            },
                            
                            {
                                xtype: 'textfield',
                                label: '所属司',
                                id:'ASSET_COMPANY_NAME',
                                labelWidth: '40%',
                                placeHolder: '请输入所属司',
                                readOnly:true
                            },
                            {
                                xtype: 'selectfield',
                                label: '所属站',
                                id:'Action_Asset_Station_Id',
                                labelWidth: '40%',
                                placeHolder: '请选择',
                                options: [
                                    {
                                        text: '请选择',
                                        value: ''
                                    },
                                    {
                                    	text: '白云站',
                                    	value: '白云站'
                                    },
                                    {
                                    	text: '从化站',
                                    	value: '从化站'
                                    },
                                    {
                                    	text: '番禺站',
                                    	value: '番禺站'
                                    }
                                ],
                                usePicker: 'auto'
                            },
                            {
                                xtype: 'textnumfield',
                                label: '层',
                                id:'Action_Asset_Floor',
                                labelWidth: '40%',
                                placeHolder: '请输入层',
                                readOnly: false,
                                required:true,
                            },
                            {
                                xtype: 'textnumfield',
                                label: '站',
                                id:'Action_Asset_Stop',
                                labelWidth: '40%',
                                placeHolder: '请输入站',
                                readOnly: false,
                                required:true,
                            },
                            {
                                xtype: 'textfield',
                                label: '无工号说明',
                                id:'NO_ASSET_COMMENT',
                                labelWidth: '40%',
                                placeHolder: '请输入说明',
                                readOnly: false
                            },
                            {
                                xtype: 'selectfield',
                                //hidden:true,
                                //readOnly: true,
                                label: '确认工号',
                                id:'SURE_ELEVATOR',
                                labelWidth: '40%',
                                placeHolder: '请选择',
                                options: [
                                    {
                                        text: '请选择',
                                        value: ''
                                    },
                                    {
                                        text: '是',
                                        value: '是'
                                    },
                                    {
                                        text: '否',
                                        value: '否'
                                    },
                                    
                                ],
                                usePicker: 'auto',
                                required:true,
                            },
                            {
                                xtype: 'selectfield',
                                label: '使用状态',
                                id:'Using_State',
                                labelWidth: '40%',
                                placeHolder: '请选择',
                                options: [
                                          {
                                              text: '请选择',
                                              value: ''
                                          },
                                          {
                                              text: '土建装修',
                                              value: '土建装修'
                                          },
                                          {
                                              text: '刚移交物业',
                                              value: '刚移交物业'
                                          },
                                          {
                                              text: '已移交物业',
                                              value: '已移交物业'
                                          }
                                      ],
                                /*options: [
                                    {
                                        text: '请选择',
                                        value: ''
                                    },
                                    {
                                        text: '土建装修（技监发证-移交物业）',
                                        value: '土建装修（技监发证-移交物业）'
                                    },
                                    {
                                        text: '刚移交物业（整改保障阶段）',
                                        value: '刚移交物业（整改保障阶段）'
                                    },
                                    {
                                        text: '已移交物业（正常保养阶段）',
                                        value: '已移交物业（正常保养阶段）'
                                    }
                                ],*/
                                usePicker: 'auto',
                                required:true,
                            },
                            {
                                xtype: 'selectfield',
                                label: '合同状态',
                                id:'ASSET_AGREE_STATUS_CAL',
                                labelWidth: '40%',
                                placeHolder: '请选择',
                                options: [
                                    {
                                        text: '请选择',
                                        value: ''
                                    },
                                    {
                                        text: '无合同',
                                        value: '无合同'
                                    },
                                    {
                                        text: '有合同',
                                        value: '有合同'
                                    },
                                    {
                                        text: '未移交',
                                        value: '未移交'
                                    }
                                ],
                                usePicker: 'auto',
                                listeners:{
                                	change:function(obj, newValue, oldValue, eOpts ){
                                	   if(newValue=="有合同"){
                                		   Ext.getCmp('ASSET_AGREE_BUSINESS_TYPE').setReadOnly(false);
                                		   Ext.getCmp('ASSET_AGREE_BUSINESS_TYPE').setRequired(true);
                                	   }else{
                                		   Ext.getCmp('ASSET_AGREE_BUSINESS_TYPE').setReadOnly(true);
                                		   Ext.getCmp('ASSET_AGREE_BUSINESS_TYPE').setRequired(false);
                                	   }
                                	}
                                },
                                required:true,
                            },
                            {
                                xtype: 'selectfield',
                                label: '业务类型',
                                id:'ASSET_AGREE_BUSINESS_TYPE',
                                labelWidth: '40%',
                                placeHolder: '请选择',
                                readOnly:true,
                                options: [
                                    {
                                        text: '请选择',
                                        value: ''
                                    },{
                                    	 text: '保养',
                                         value: '保养'
                                    },{
                                    	 text: '保修',
                                         value: '保修'
                                    }
                                ],
                                usePicker: 'auto'
                            }
                        ]
                    },
                    {
                        xtype: 'fieldset',
                        title: '受信过程记录',
                        items: [
                            {
                                xtype: 'textfield',
                                label: '发生时间',
                                id:'HAPPEN_TIME',
                                labelWidth: '40%',
                                placeHolder: '请输入发生时间',
                                readOnly:true,
                                datePicker: true,
                                clearIcon:true,
                                listeners:{
                                	focus:function(){
                                		need_text_id='HAPPEN_TIME';
                                		var SOUXIN_TIME=Ext.getCmp('SOUXIN_TIME').getValue();
                               		    var HAPPEN_TIME=Ext.getCmp('HAPPEN_TIME').getValue();
                            			if(HAPPEN_TIME!=''){
                            				initDate(HAPPEN_TIME,'发生时间');
                            			}else{
                            				initDate(SOUXIN_TIME,'发生时间');
                            			}
                            			picker_show.show();
                                	}
                                },
                                required:true,
                            },
                            {
                                xtype: 'textfield',
                                label: '受信时间',
                                id:'SOUXIN_TIME',
                                labelWidth: '40%',
                                placeHolder: '请输入受信时间',
                                readOnly:true,
                                datePicker: true,
                                listeners:{
                                	focus:function(){           
                                		return;//受信时间不可更改
                                		need_text_id='SOUXIN_TIME';
                            			initDate(Ext.getCmp('SOUXIN_TIME').getValue(),'受信时间');
                            			picker_show.show();
                                	}
                                },
                                required:true,
                            },
                            {
                                xtype: 'textfield',
                                label: '出发时间',
                                id:'SET_OUT_TIME',
                                labelWidth: '40%',
                                placeHolder: '请输入出发时间',
                                readOnly:true,
                                datePicker: true,
                                listeners:{
                                	focus:function(){
                                		need_text_id='SET_OUT_TIME';
                                		var HAPPEN_TIME=Ext.getCmp('HAPPEN_TIME').getValue();
                                		var SOUXIN_TIME=Ext.getCmp('SOUXIN_TIME').getValue();
                                		var SET_OUT_TIME=Ext.getCmp('SET_OUT_TIME').getValue();
                                		if(SET_OUT_TIME!=''){
                                			initDate(SET_OUT_TIME,'出发时间');
                                		}else if(SOUXIN_TIME!=''){
                                			initDate(SOUXIN_TIME,'出发时间');
                                		}else{
                                			initDate(HAPPEN_TIME,'出发时间');
                                		}
                            			picker_show.show();
                                	}
                                },
                                required:true,
                            },
                            {
                                xtype: 'textfield',
                                label: '到达时间',
                                id:'FR_ARRIVED_TIME',
                                labelWidth: '40%',
                                placeHolder: '请输入到达时间',
                                readOnly:true,
                                datePicker: true,
                                listeners:{
                                	focus:function(){
                                		need_text_id='FR_ARRIVED_TIME';
                                		var HAPPEN_TIME=Ext.getCmp('HAPPEN_TIME').getValue();
                                		var SOUXIN_TIME=Ext.getCmp('SOUXIN_TIME').getValue();
                                		var SET_OUT_TIME=Ext.getCmp('SET_OUT_TIME').getValue();
                                		var FR_ARRIVED_TIME=Ext.getCmp('FR_ARRIVED_TIME').getValue();
                                		if(FR_ARRIVED_TIME!=''){
                                			initDate(FR_ARRIVED_TIME,'到达时间');
                                		}else if(SET_OUT_TIME!=''){
                                			initDate(SET_OUT_TIME,'到达时间');
                                		}else if(SOUXIN_TIME!=''){
                                			initDate(SOUXIN_TIME,'到达时间');
                                		}else{
                                			initDate(HAPPEN_TIME,'到达时间');
                                		}
                            			picker_show.show();
                                	}
                                },
                                required:true,
                            }, 
                            {
                                xtype: 'textfield',
                                label: '恢复时间',
                                id:'RECOVERRUN_TIME',
                                labelWidth: '40%',
                                placeHolder: '请输入恢复运行时间',
                                readOnly:true,
                                datePicker: true,
                                listeners:{
                                	focus:function(){
                                		need_text_id='RECOVERRUN_TIME';
                                		var HAPPEN_TIME=Ext.getCmp('HAPPEN_TIME').getValue();
                                		var SOUXIN_TIME=Ext.getCmp('SOUXIN_TIME').getValue();
                                		var SET_OUT_TIME=Ext.getCmp('SET_OUT_TIME').getValue();
                                		var FR_ARRIVED_TIME=Ext.getCmp('FR_ARRIVED_TIME').getValue();
                                		var RECOVERRUN_TIME=Ext.getCmp('RECOVERRUN_TIME').getValue();
                            			if(RECOVERRUN_TIME!=''){
                            				initDate(RECOVERRUN_TIME,'恢复时间');
                            			}else if(FR_ARRIVED_TIME!=''){
                            				initDate(FR_ARRIVED_TIME,'恢复时间');
                            			}else if(SET_OUT_TIME!=''){
                            				initDate(SET_OUT_TIME,'恢复时间');
                            			}else if(SOUXIN_TIME!=''){
                            				initDate(SOUXIN_TIME,'恢复时间');
                            			}else{
                            				initDate(HAPPEN_TIME,'恢复时间');
                            			}
                            			picker_show.show();
                                	}
                                },
                                required:true,
                            },
                            {
                                xtype: 'textfield',
                                label: '完成时间',
                                id:'FR_COMPLETED_TIME',
                                labelWidth: '40%',
                                placeHolder: '请输入完成时间',
                                readOnly:true,
                                datePicker: true,
                                listeners:{
                               	focus:function(){
                                		need_text_id='FR_COMPLETED_TIME';
                                		var HAPPEN_TIME=Ext.getCmp('HAPPEN_TIME').getValue();
                                		var SOUXIN_TIME=Ext.getCmp('SOUXIN_TIME').getValue();
                                		var SET_OUT_TIME=Ext.getCmp('SET_OUT_TIME').getValue();
                                		var FR_ARRIVED_TIME=Ext.getCmp('FR_ARRIVED_TIME').getValue();
                                		var RECOVERRUN_TIME=Ext.getCmp('RECOVERRUN_TIME').getValue();
                            			var FR_COMPLETED_TIME=Ext.getCmp('FR_COMPLETED_TIME').getValue();
                            			if(FR_COMPLETED_TIME!=''){
                            				initDate(FR_COMPLETED_TIME,'完成时间');
                            			}else if(RECOVERRUN_TIME!=''){
                            				initDate(RECOVERRUN_TIME,'完成时间');
                            			}else if(FR_ARRIVED_TIME!=''){
                            				initDate(FR_ARRIVED_TIME,'完成时间');
                            			}else if(SET_OUT_TIME!=''){
                            				initDate(SET_OUT_TIME,'完成时间');
                            			}else if(SOUXIN_TIME!=''){
                            				initDate(SOUXIN_TIME,'完成时间');
                            			}else{
                            				initDate(HAPPEN_TIME,'完成时间');
                            			}
                            			picker_show.show();
                                	}
                                },
                                required:true,
                            },
                            {
                                xtype: 'selectfield',
                                label: '完成情况',
                                id:'COMPLETE_STATUS',
                                labelWidth: '40%',
                                placeHolder: '请选择',
                                options: [
                                    {
                                        text: '请选择',
                                        value: ''
                                    },
                                    {
                                        text: '1.完成',
                                        value: '1.完成'
                                    },
                                    {
                                        text: '2.要进行再调查',
                                        value: '2.要进行再调查'
                                    },
                                    {
                                        text: '3.再调查完成',
                                        value: '3.再调查完成'
                                    }
                                ],
                                usePicker: false,
                                required:true,
//                                usePicker: 'auto'
                            },
                            {
                                xtype: 'textfield',
                                label: '应对说明',
                                id:'REPLY_TIME_COMMENTS',
                                labelWidth: '40%',
                                placeHolder: '请输入应对时间说明',
                                readOnly: false
                            },
                            {
                                xtype: 'textfield',
                                label: '不运行说明',
                                id:'NOT_RUN_COMMENTS',
                                labelWidth: '40%',
                                placeHolder: '请输入不运行时间说明',
                                readOnly: false
                            },
                            {
                                xtype: 'textfield',
                                label: '故障内容',
                                labelWidth: '40%',
                                id:'FIELD_LIFT_FAULT',
                                placeHolder: '请输入到场故障内容',
                                readOnly: false,
                                required:true,
                            },
                            {
                                xtype: 'selectfield',
                                label: '直/扶梯',
                                id:'ELEVATOR_TYPE',
                                labelWidth: '40%',
                                placeHolder: '请选择',
                                options: [
                                    {
                                        text: '请选择',
                                        value: ''
                                    },
                                    {
                                        text: '直梯',
                                        value: '直梯'
                                    },
                                    {
                                        text: '扶梯',
                                        value: '扶梯'
                                    },
                                    
                                ],
                                usePicker: 'auto',
                                listeners:{
                               
                                },
                                required:true,
                            },
                            {
                                xtype: 'selectfield',
                                label: '故障状态',
                                id:'FIELD_FAULT_STATUS',
                                labelWidth: '40%',
                                placeHolder: '请选择',
                                options: [
                                ],
                                usePicker: 'auto',
                                required:true,
                            },
                            {
                                xtype: 'selectfield',
                                label: '机器代码',
                                id:'SECOND_FAULT_SEQUENCE',
                                labelWidth: '40%',
                                placeHolder: '请选择',
                                options: [
                                    {
                                        text: '请选择',
                                        value: ''
                                    }
                                ],
                                usePicker: 'auto',
                                required:true,
                            },
                            {
                                xtype: 'textfield',
                                label: '故障零件',
                                id:'FAULT_POINT',
                                labelWidth: '40%',
                                placeHolder: '请输入到故障零件',
                                readOnly: false,
                                required:true,
                            },
                            {
                                xtype: 'textfield',
                                label: '变异描述',
                                id:'FAULT_PART_DESCRIPTION',
                                labelWidth: '40%',
                                placeHolder: '请输入故障零件变异描述',
                                readOnly: false,
                                required:true,
                            },
                            {
                                xtype: 'selectfield',
                                label: '是否困人',
                                id:'SR_BOX_UP',
                                labelWidth: '40%',
                                placeHolder: '请选择',
                                options: [
                                    {
                                        text: '请选择',
                                        value: ''
                                    },
                                    {
                                        text: '是',
                                        value: '是'
                                    },
                                    {
                                        text: '否',
                                        value: '否'
                                    },
                                ],
                                usePicker: 'auto',
                                listeners:{
                                	change:function(obj, newValue, oldValue, eOpts){
                                		if(newValue=='是'){
                                			Ext.getCmp('FIELD_RESCUE_STYLE').setReadOnly(false);
                                			Ext.getCmp('BOX_UP_TIME').setReadOnly(false);
                                			Ext.getCmp('BOX_UP_NUMBER').setReadOnly(false);
                                			//显示必填
                                			//困人时间
                                			Ext.getCmp('BOX_UP_TIME').setRequired(true);
                                			//困人数量
                                			Ext.getCmp('BOX_UP_NUMBER').setRequired(true);
                                			//脱困情况
                                			Ext.getCmp('FIELD_RESCUE_STYLE').setRequired(true);
                                		}else{
                                			Ext.getCmp('FIELD_RESCUE_STYLE').setReadOnly(true);
                                			Ext.getCmp('FIELD_RESCUE_STYLE').setValue();
                                			Ext.getCmp('BOX_UP_NUMBER').setReadOnly(true);
                                			Ext.getCmp('BOX_UP_NUMBER').setValue();
                                			Ext.getCmp('BOX_UP_TIME').setReadOnly(true);
                                			Ext.getCmp('BOX_UP_TIME').setValue();
                                			
                                			//取消必填
                                			//困人时间
                                			Ext.getCmp('BOX_UP_TIME').setRequired(false);
                                			//困人数量
                                			Ext.getCmp('BOX_UP_NUMBER').setRequired(false);
                                			//脱困情况
                                			Ext.getCmp('FIELD_RESCUE_STYLE').setRequired(false);
                                		}
                                	}
                                },
                                required:true,
                            },{
                                xtype: 'textnumfield',
                                label: '困人时间',
                                id:'BOX_UP_TIME',
                                labelWidth: '40%',
                                placeHolder: '请输入分钟',
                                readOnly: false
                            },
                           
                            {
                                xtype: 'textnumfield',
                                label: '困人数量',
                                id:'BOX_UP_NUMBER',
                                labelWidth: '40%',
                                placeHolder: '请输入困人数量',
                                readOnly: false
                            },
                            {
                                xtype: 'selectfield',
                                label: '脱困情况',
                                id:'FIELD_RESCUE_STYLE',
                                labelWidth: '40%',
                                placeHolder: '请选择',
                                readOnly: true,
                                options:[{
                                	text:'请选择',
                                	value:''
                                },
                                {
                                	text:'乘客自行脱困',
                                	value:'乘客自行脱困'
                                },{
                                	text:'管理人员救出',
                                	value:'管理人员救出'
                                },{
                                	text:'保养员救出',
                                	value:'保养员救出'
                                },{
                                	text:'救出情况不明',
                                	value:'救出情况不明'
                                }]
                            },
                            {
                                xtype: 'textfield',
                                label: '防止对策',
                                id:'AVOID_RESOURCE',
                                labelWidth: '40%',
                                placeHolder: '请输入防止再发生对策',
                                readOnly: false
                            },
                            {
                                xtype: 'textfield',
                                label: '备注',
                                id:'FAULT_AUDIT_COMMENT',
                                labelWidth: '40%',
                                readOnly: false
                            },  {
                                xtype: 'textfield',
                                label: '审核状态',
                                id:'AUDITING_STATUS',
                                labelWidth: '40%',
                                readOnly: true
                            },   {
                                xtype: 'textfield',
                                label: '合同号',
                                id:'INSTALL_CONTR_NUM',
                                labelWidth: '40%',
                                readOnly: true
                            },{
                                xtype: 'selectfield',
                                label: '客户评价',
                                id:'ACCOUNT_ESTIMATE',
                                labelWidth: '40%',
                                placeHolder: '请选择',
                                readOnly: false,
                                options:[{
                                	text:'请选择',
                                	value:''
                                },{
                                	text:'很满意',
                                	value:'很满意'
                                },{
                                	text:'满意',
                                	value:'满意'
                                },{
                                	text:'一般',
                                	value:'一般'
                                },{
                                	text:'不满意',
                                	value:'不满意'
                                }],
                                required:true,
                            },{
                            	xtype:'panel',
                            	layout:{
                            		type:'hbox' 
                            	},
                            	items:[ {
                                    xtype: 'searchfield',
                                    height: 40,
                                    width: '90%',
                                    label: '客户',
                                    id:'ACCOUNT_NAME',
                                    labelWidth: '42%',
                                    name: '',
                                    placeHolder: '请输入搜索关键字'
                                },
                                {
                                    xtype: 'button',
                                    height: 41,
                                    style: 'border:0;',
                                    width: '10%',
                                    id:'search_Custom',
                                    iconCls: 'search',
                                    text: ''
                               }]
                            },
                            
                            {
                                xtype: 'hiddenfield',
                                label: '公司ID',
                                id:'COMPANY_ID',
                            },
                            {
                                xtype: 'hiddenfield',
                                label: '活动id',
                                id:'ACTIVITY_ID',
                            },
                            {
                                xtype: 'hiddenfield',
                                label: '用户ID',
                                id:'USER_ID',
                            },
                            {
                            	xtype:'hiddenfield',
                            	label:'AccountID',
                            	id:'ACCOUNT_ID'
                            },
                            {
                            	xtype:'hiddenfield',
                            	label:'ASSET_ID',
                            	id:'ASSET_ID'
                            },{
                            	xtype:'hiddenfield',
                            	label:'ASSET_COMPANY_ID',
                            	id:'ASSET_COMPANY_ID'
                            },
                            {
                                xtype: 'panel',
                                layout: {
                                    type: 'hbox',
                                    align: 'center'
                                },
                                items: [
                                    {
                                        xtype: 'spacer'
                                    },
                                    {
                                        xtype: 'button',
                                        margin: 10,
                                        width: 100,
                                        id:'saveAllReport',
                                        iconCls: 'action',
                                        text: '保存'
                                    },
                                    {
                                        xtype: 'button',
                                        margin: 10,
                                        width: 100,
                                        id:'returnAllReport',
                                        iconCls: 'reply',
                                        text: '撤回',
                                        hidden:true
                                    },
                                    {
                                        xtype: 'button',
                                        margin: 10,
                                        width: 100,
                                        id:'submitAllReport',
                                        iconCls: 'arrow_up',
                                        text: '提交'
                                    },
                                    {
                                        xtype: 'spacer'
                                    }
                        ]
                    },{
                    	xtype: 'textfield',
                        label: '提交时间',
                        labelWidth: '40%',
                        id:'FR_SUBMISSION_TIME',
                        readOnly:true,
                        disabled:true,
                    },
                        ]
                    },
                ]
            }
        ]
    },
    
    initialize:function(){
    	
    	//服务来源
    	var FWLY='';
    	if(Ext.getCmp('SERVICE_REQUEST_SOURCE')){
    		FWLY=Ext.getCmp('SERVICE_REQUEST_SOURCE').getValue();
    	}
    	console.log('FWLY:'+FWLY);
    	var ASSET_NUM=Ext.getCmp('FOR_ASSET_NUM').getValue();
    	//console.log(ASSET_NUM);
    	//console.log(userid);
    	if(Ext.getCmp('ACTIVITYID')){
    		var ACTIVITY_ID=Ext.getCmp('ACTIVITYID').getValue();
        	Ext.getCmp('ACTIVITY_ID').setValue(ACTIVITY_ID);
    	}
    	
    	//都没法获取到MainFaultRecord
    	/*else if(MainFaultRecord){
    		var ACTIVITY_ID=MainFaultRecord.data.ACTIVITY_ID;
    		Ext.getCmp('ACTIVITY_ID').setValue(ACTIVITY_ID);
    	}*/
    	
    	
    	//console.log(ACTIVITY_ID);
    	//检查进入时状态是什么，如果是已提交或者未提交，设置用户是否能操作数据
    	if(Ext.getCmp('fault_list')){
    		var fault_listId=Ext.getCmp('fault_list').getActiveItem().getId();
        	if(fault_listId=='FaultHandWYSHButton'||fault_listId=='FaultHandWYTJButton'){
        		WL.Toast.show('已提交或已审核,不能修改故障信息.');
        		console.log('已提交或已审核,不能修改故障信息.');
        		var viewGZ=Ext.getCmp('faultHandlingReportPanel');
        		viewGZ.disable();
        		var NeedLister = viewGZ.query('textfield');
        		console.log(NeedLister);
        		for(var i=0;i<NeedLister.length;i++){
        			NeedLister[i].setReadOnly(true);
        		};
        		//Ext.getCmp('saveAllReport').setDisabled(true);
        		//Ext.getCmp('submitAllReport').setDisabled(true);
        	}
    	}
    	 
    	//获取到后台数据，开始设置值
    	var getResult=function(res){
    		//console.log('进入到数据赋值里面');
    		//console.log('-------------------res-------获取返回值');
    		//console.log(JSON.stringify(res));
    		//console.log('-------------------res-------');
    		
    		//zhj 故障状态 (来源FaultHandlingReportPanelCtrl,数据写死)
    		try{
    			Ext.getCmp('FIELD_FAULT_STATUS').setOptions(Arrive_staues);    			
    		}catch(e){
    			console.log('故障状态获取失败');
    			WL.Toast.show('故障状态获取失败');
    		}
    		
    		//
    		try{
    			var arr1=res.rows3;
    			//console.log('-------------------rows3-------');
    			//console.log(arr1);
    			//console.log('-------------------rows3-------');
    			var data1="[";
    			data1+="{'value':'请选择','text':'请选择'},";
    			for(var i=0;i<arr1.length;i++){
    				if(i!=arr1.length-1){
    					data1+="{'value':'"+arr1[i].CODE+"','text':'"+arr1[i].MS+"'},";
    				}else{
    					data1+="{'value':'"+arr1[i].CODE+"','text':'"+arr1[i].MS+"'}";
    				}
    			}
    			data1+="]";
    			//“直/扶梯”下拉列表的改动会改变机器代码，所以要更改FaultHandlingReportPanelCtrl控制器的ELEVATOR_TYPE方法中所调用的Type方法
    			//机器代码
       	  	 	Ext.getCmp('SECOND_FAULT_SEQUENCE').setOptions(eval(data1));
    		}catch(e){
    			console.log('机器代码获取失败');
    			WL.Toast.show('机器代码获取失败');
    		}
    	  	 
    		try{
    			var arr=res.rows4;
    			var data="[";
    			for(var i=0;i<arr.length;i++){
    				if(i!=arr.length-1){
    					data+="{'value':'"+arr[i].STATION_CODE+"','text':'"+arr[i].STATION_NAME+"'},";
    				}else{
    					data+="{'value':'"+arr[i].STATION_CODE+"','text':'"+arr[i].STATION_NAME+"'}";
    				}
    			}
    			data+="]";
    			//所属站
    			Ext.getCmp('Action_Asset_Station_Id').setOptions(eval(data)); 
    		}catch(e){
    			console.log('所属站获取失败');
    			WL.Toast.show('所属站获取失败');
    		}
        	 
    		try{
    			//直/扶梯
    			Ext.getCmp('ELEVATOR_TYPE').setValue(res.rows[0].ELEVATOR_TYPE);    			
    		}catch(e){
    			console.log('直/扶梯获取失败');
    			WL.Toast.show('直/扶梯获取失败');
    		}
        	 
    		
    		try{
    			console.log('----------请求编号------------');
    			//console.log(MainFaultRecord.data.SR_NUMBER);
    			var acb=Ext.getCmp('SR_NUMBER').getValue();
    			console.log(acb);
    			//请求编号
    			//都没法获取到MainFaultRecord
    			/*if(MainFaultRecord){
           		 	Ext.getCmp('SR_Number').setValue(MainFaultRecord.data.SR_NUMBER);
	           	}else{
	           		Ext.getCmp('SR_Number').setValue(Ext.getCmp('SR_NUMBER').getValue());
	           	}*/
    			Ext.getCmp('SR_Number').setValue(Ext.getCmp('SR_NUMBER').getValue());
    		}catch(e){
    			console.log('请求编号获取失败');
    			WL.Toast.show('请求编号获取失败');
    		}
        	 
    		/*try{
    			//判断rows2是否有数据，如果没有用rows有用rows2
    			//rows为故障自带数据
    			//rows2为保存后数据
    			//console.log('-------------------rows值-------获取返回值');
    			//console.log(JSON.stringify(res.rows));
    			//console.log('-------------------rows2值-------获取返回值');
    			//console.log(JSON.stringify(res.rows2));
    		}catch(e){
    			console.log('获取失败res');
    			WL.Toast.show('获取失败res');
    		}*/
        	
    		
    		//是否提交判断
        	var TJflag='';
        	
        	try{
        		if(res.rows2==''||res.rows==null||typeof(res.rows2)=='undefined'){
        			console.log('进Row');
        			TJflag=res.rows[0].AUDITING_STATUS;
        			
        			if(FWLY=='MAS报出'||TJflag== '已提交'){
        				Ext.getCmp('ASSET_NUM').setValue(res.rows[0].ASSET_NUM);
        				Ext.getCmp('Action_Asset_Address').setValue(res.rows[0].FAULT_ADDRESS);
        				console.log('获取失败res');
        				WL.Toast.show('获取失败res');	 Ext.getCmp('Action_Asset_Domain').setValue(res.rows[0].FAULT_DOMAIN);
        				Ext.getCmp('Action_Asset_Edifice').setValue(res.rows[0].FAULT_EDIFICE);
        				Ext.getCmp('Action_Elevator_Mark').setValue(res.rows[0].ACTION_ELEVATOR_MARK);
        				Ext.getCmp('Action_Elevator_floor').setValue('');
        				Ext.getCmp('ASSET_COMPANY_NAME').setValue(res.rows[0].COMPANY_NAME);
        				Ext.getCmp('Action_Asset_Floor').setValue(res.rows[0].ELEVATOR_FLOOR);
        				Ext.getCmp('Action_Asset_Stop').setValue(res.rows[0].ELEVATOR_STOP);
        				Ext.getCmp('NO_ASSET_COMMENT').setValue('');
        				Ext.getCmp('SURE_ELEVATOR').setValue(res.rows[0].SURE_ELEVATOR);
        				Ext.getCmp('ASSET_AGREE_STATUS_CAL').setValue(res.rows[0].ASSET_AGREE_STATUS_CAL);
        				Ext.getCmp('ASSET_AGREE_BUSINESS_TYPE').setValue(res.rows[0].ASSET_AGREE_BUSINESS_TYPE);
        				
        				//
        				getFlagASSET_NUM(res.rows[0].ASSET_NUM);
        			}
        			//完工时间 
        			Ext.getCmp('FR_COMPLETED_TIME').setValue(res.rows[0].REPAIR_COMPLETE_TIME);
        			
        			Ext.getCmp('FOR_ASSET_NUM').setValue(res.rows[0].ASSET_NUM);
        			Ext.getCmp('HAPPEN_TIME').setValue(res.rows[0].HAPPEN_TIME);
        			Ext.getCmp('SOUXIN_TIME').setValue(res.rows[0].SOUXIN_TIME);
        			Ext.getCmp('SET_OUT_TIME').setValue(res.rows[0].START_TIME);
        			Ext.getCmp('FR_ARRIVED_TIME').setValue(res.rows[0].ARRIVE_TIME);
        			Ext.getCmp('INSTALL_CONTR_NUM').setValue(res.rows[0].INSTALL_CONTR_NUM);
        			Ext.getCmp('COMPANY_ID').setValue(res.rows[0].COMPANY_ID);
        			Ext.getCmp('ACCOUNT_ID').setValue(res.rows[0].ACCOUNT_ID);
        			Ext.getCmp('ASSET_ID').setValue(res.rows[0].ASSET_ID);
        			Ext.getCmp('ASSET_COMPANY_ID').setValue(res.rows[0].COMPANY_ID);
        			
        			//另外得到
        			Ext.getCmp('SECOND_FAULT_SEQUENCE').setValue('');
        			Ext.getCmp('Action_Asset_Station_Id').setValue('');
        			Ext.getCmp('REPLY_TIME_COMMENTS').setValue('');
        			Ext.getCmp('NOT_RUN_COMMENTS').setValue('');
        			Ext.getCmp('FIELD_LIFT_FAULT').setValue('');
        			Ext.getCmp('FIELD_FAULT_STATUS').setValue('');
        			Ext.getCmp('FAULT_POINT').setValue('');
        			Ext.getCmp('FAULT_PART_DESCRIPTION').setValue('');
        			Ext.getCmp('BOX_UP_TIME').setValue('');
        			Ext.getCmp('BOX_UP_NUMBER').setValue('');
        			Ext.getCmp('SR_BOX_UP').setValue('');
        			Ext.getCmp('FIELD_RESCUE_STYLE').setValue('');
        			Ext.getCmp('AVOID_RESOURCE').setValue('');
        			Ext.getCmp('ACCOUNT_ESTIMATE').setValue('');
        			Ext.getCmp('COMPLETE_STATUS').setValue('');
        			Ext.getCmp('AUDITING_STATUS').setValue('');
        			Ext.getCmp('FAULT_AUDIT_COMMENT').setValue('');
        			
        			
        			
        		}else{
        			console.log('进Rows2');
        			TJflag=res.rows2[0].AUDITING_STATUS;
        			//console.log(res.rows2);
        			//if(FWLY=='MAS报出'||TJflag=='已提交'){
        			Ext.getCmp('ASSET_NUM').setValue(res.rows2[0].ASSET_NUM);
        			Ext.getCmp('Action_Asset_Address').setValue(res.rows2[0].ACTION_ASSET_ADDRESS);
        			Ext.getCmp('Action_Asset_Domain').setValue(res.rows2[0].ACTION_ASSET_DOMAIN);
        			Ext.getCmp('Action_Asset_Edifice').setValue(res.rows2[0].ACTION_ASSET_EDIFICE);
        			Ext.getCmp('Action_Elevator_Mark').setValue(res.rows2[0].ACTION_ELEVATOR_MARK);
        			Ext.getCmp('Action_Elevator_floor').setValue(res.rows2[0].FAULT_FLOOR);
        			Ext.getCmp('ASSET_COMPANY_NAME').setValue(res.rows2[0].COMPANY_NAME);
        			Ext.getCmp('Action_Asset_Station_Id').setValue(res.rows2[0].STATION_NAME);
        			Ext.getCmp('Action_Asset_Floor').setValue(res.rows2[0].ACTION_ASSET_FLOOR);
        			Ext.getCmp('Action_Asset_Stop').setValue(res.rows2[0].ACTION_ASSET_STOP);
        			Ext.getCmp('NO_ASSET_COMMENT').setValue(res.rows2[0].NO_ASSET_COMMENT);
        			Ext.getCmp('SURE_ELEVATOR').setValue(res.rows2[0].SURE_ELEVATOR);
        			Ext.getCmp('ASSET_AGREE_STATUS_CAL').setValue(res.rows2[0].ASSET_AGREE_STATUS_CAL);
        			Ext.getCmp('ASSET_AGREE_BUSINESS_TYPE').setValue(res.rows2[0].ASSET_AGREE_BUSINESS_TYPE);        			 
        			// xcx 2016-4-29
        			Ext.getCmp('Using_State').setValue(res.rows2[0].USED_STATUS);
        			Ext.getCmp('SECOND_FAULT_SEQUENCE').setValue(res.rows2[0].SECOND_FAULT_SEQUENCE);
        			//Ext.getCmp('COMPANY_ID').setValue('');
        			//}
        			Ext.getCmp('FOR_ASSET_NUM').setValue(res.rows2[0].ASSET_NUM);
        			Ext.getCmp('ACCOUNT_NAME').setValue(res.rows2[0].ACCNT_NAME);
        			Ext.getCmp('REPLY_TIME_COMMENTS').setValue(res.rows2[0].REPLY_TIME_COMMENTS);
        			Ext.getCmp('NOT_RUN_COMMENTS').setValue(res.rows2[0].NOT_RUN_COMMENTS);
        			Ext.getCmp('FIELD_LIFT_FAULT').setValue(res.rows2[0].FIELD_LIFT_FAULT);
        			Ext.getCmp('FIELD_FAULT_STATUS').setValue(res.rows2[0].FIELD_FAULT_STATUS);
        			Ext.getCmp('HAPPEN_TIME').setValue(res.rows2[0].HAPPEN_TIME);
        			Ext.getCmp('SOUXIN_TIME').setValue(res.rows2[0].SOUXIN_TIME);
        			Ext.getCmp('SET_OUT_TIME').setValue(res.rows2[0].SET_OUT_TIME);
        			Ext.getCmp('FR_ARRIVED_TIME').setValue(res.rows2[0].FR_ARRIVED_TIME);
        			Ext.getCmp('RECOVERRUN_TIME').setValue(res.rows2[0].RECOVERRUN_TIME);
        			Ext.getCmp('FR_COMPLETED_TIME').setValue(res.rows2[0].FR_COMPLETED_TIME);
        			Ext.getCmp('FAULT_POINT').setValue(res.rows2[0].FAULT_POINT);
        			Ext.getCmp('FAULT_PART_DESCRIPTION').setValue(res.rows2[0].FAULT_PART_DESCRIPTION);
        			Ext.getCmp('BOX_UP_TIME').setValue(res.rows2[0].BOX_UP_TIME);
        			Ext.getCmp('BOX_UP_NUMBER').setValue(res.rows2[0].BOX_UP_NUMBER);
        			Ext.getCmp('SR_BOX_UP').setValue(res.rows2[0].SR_BOX_UP);
        			Ext.getCmp('FIELD_RESCUE_STYLE').setValue(res.rows2[0].FIELD_RESCUE_STYLE);
        			Ext.getCmp('AVOID_RESOURCE').setValue(res.rows2[0].AVOID_RESOURCE);
        			Ext.getCmp('ACCOUNT_ESTIMATE').setValue(res.rows2[0].ACCOUNT_ESTIMATE);
        			Ext.getCmp('COMPLETE_STATUS').setValue(res.rows2[0].COMPLETE_STATUS);
        			Ext.getCmp('AUDITING_STATUS').setValue(res.rows2[0].AUDITING_STATUS);
        			Ext.getCmp('FAULT_AUDIT_COMMENT').setValue(res.rows2[0].FAULT_AUDIT_COMMENT);
        			Ext.getCmp('INSTALL_CONTR_NUM').setValue(res.rows2[0].INSTALL_CONTR_NUM);
        			Ext.getCmp('ACCOUNT_ID').setValue(res.rows2[0].ACCOUNT_ID);
        			Ext.getCmp('ASSET_ID').setValue(res.rows2[0].ASSET_ID);
        			Ext.getCmp('ASSET_COMPANY_ID').setValue(res.rows2[0].ASSET_COMPANY_ID);
        			
        			//
        			getFlagASSET_NUM(res.rows2[0].ASSET_NUM);
        		};
        		
        	}catch(e){
        		console.log('f赋值失败');
    			WL.Toast.show('f赋值失败');
        	}
        	 
        	 
        	 
        	//console.log('---AUDITING_STATUS',res.rows2[0].FR_SUBMISSION_TIME);
        	//如果故障报告已经提交，显示提交时间
        	console.log('TJflag:'+TJflag);
        	if(TJflag == '已提交'){
        		Ext.getCmp('FR_SUBMISSION_TIME').setValue(res.rows2[0].FR_SUBMISSION_TIME);
        	}
	
	        //受信时间
	        var SOUXIN_TIME=Ext.getCmp('SET_OUT_TIME').getValue();
	        //如果有出发时间和到场时间，并且到场时间超过出发时间半个小时，那么“应对说明”为必填
	        var FR_ARRIVED_TIME=Ext.getCmp('FR_ARRIVED_TIME').getValue();
     		var REPLY_TIME=comptimes(SOUXIN_TIME,FR_ARRIVED_TIME);
 	    	if(SOUXIN_TIME!=''&&FR_ARRIVED_TIME!=''&&REPLY_TIME>0.5){
 	    		 Ext.getCmp('REPLY_TIME_COMMENTS').setRequired(true);
 	    	};
 	    	//如果有出发时间和完工时间，“完成时间”超过“受信时间”5个小时，输入不运行时间说明
      		var RECOVERRUN_TIME=Ext.getCmp('RECOVERRUN_TIME').getValue();
      		var NOT_RUN_TIME=comptimes(SOUXIN_TIME,RECOVERRUN_TIME);
      		if(SOUXIN_TIME!=''&&RECOVERRUN_TIME!=''&&NOT_RUN_TIME>=5){
  	    		 Ext.getCmp('NOT_RUN_COMMENTS').setRequired(true);
  	    	};
        	 
  	    	//判断是否自带故障工号
  	    	function getFlagASSET_NUM(data){
  	    		if(data!=''){
  	    			//alert(data);
  	    			Ext.getCmp('ASSET_NUM_HIDDEN').setValue('Yes');
  	    		}
  	    	};
  	    	
         };
    	 //1-4H104B
    	 var content="{ACTIVITY_ID:"+ACTIVITY_ID+",ASSET_NUM:'"+ASSET_NUM+"',USERID:'"+userid+"'}";
    	 //console.log('故障报告查询条件');
    	 //console.log(content);
    	 connectServer(getResult,'gzbaogaoluruAction.do?method=Search_Allinfo', content);
    	 //console.log('---init end');
    }

});
/**
 * 访问网络
 */
var connectServer =function(fn, url, params) {
	myLoading.show();
	var invocationData = {  
              adapter : 'HttpAdapter_PDA',  
              procedure : 'getStories_pda',
              parameters : [url, params]
	};
  	WL.Client.invokeProcedure(invocationData, {
  		 timeout:180000,
          onSuccess : function (result) {
          	var httpStatusCode = result.status;
          	if (200 == httpStatusCode) {
                  var invocationResult = result.invocationResult;
                  var isSuccessful = invocationResult.isSuccessful;
                  if (true == isSuccessful) {
                  	var status = invocationResult.status.code;
                  	if (status == 250) {
                  		myLoading.hide();
                          var result = invocationResult.content;
                          // 转化成JSON对象
                          try {
                        	  var json = eval("("+ result +")");
                        	  fn(json);
                          } catch(e) {
                        	//  Ext.Msg.alert('提示',"服务器出错！");
                          }
                  	} else {
                  		myLoading.hide();
                  		/*var result = invocationResult.content;
                        var json = eval("("+ result +")");
                  		if (json.msginfo != '') {
                  			Ext.Msg.alert('提示',json.msginfo);
                  		} else {
                  			Ext.Msg.alert('提示',"服务器出错！");
                  		}*/
                  		Ext.Msg.alert('提示',"服务器出错！");
                  	}
                  } else {
                	  	myLoading.hide();
                	  	Ext.Msg.alert('提示',"网络出错！");
                  }
              } else {
            	  	myLoading.hide();
            	  	Ext.Msg.alert('提示',"网络出错！");
              }
          },  
          onFailure : function () {
        	  myLoading.hide();
        	  Ext.Msg.alert('提示',"失败！");
          }
      });
};
