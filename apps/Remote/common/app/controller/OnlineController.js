/*
 * File: app/controller/OnlineController.js
 *
 * This file was generated by Sencha Architect
 * http://www.sencha.com/products/architect/
 *
 * This file requires use of the Sencha Touch 2.4.x library, under independent license.
 * License of Sencha Architect does not include license for Sencha Touch 2.4.x. For more
 * details see http://www.sencha.com/license or contact license@sencha.com.
 *
 * This file will be auto-generated each and everytime you save your project.
 *
 * Do NOT hand edit this file.
 */

Ext.define('HelcRemote.controller.OnlineController', {
    extend: 'Ext.app.Controller',

    config: {
        control: {
            "list#Online_ListNav1": {
                itemtap: 'onOnline_ListNav1ItemTap'
            },
            "list#Online_ListNav2": {
                itemtap: 'onOnline_ListNav2ItemTap'
            },
            "button#Online_BtnOnline1": {
                tap: 'onOnline_BtnOnline1Tap'
            },
            "button#Online_BtnOnline2": {
                tap: 'onOnline_BtnOnline2Tap'
            },
            "button#online_FaultPublish_BtnAll": {
                tap: 'onOnline_FaultPublish_BtnAllTap'
            },
            "button#online_FaultPublish_BtnTrap": {
                tap: 'onOnline_FaultPublish_BtnTrapTap'
            },
            "dataview#online_FaultPublish_List": {
                itemtap: 'onOnline_FaultPublish_ListItemTap'
            },
            "panel#Online_subNav2": {
                initialize: 'onOnline_subNav2Initialize'
            }
        }
    },

    onOnline_ListNav1ItemTap: function(dataview, index, target, record, e, eOpts) {
        // 工作模式1 - 菜单
        var parent = Ext.getCmp('Online_subNav1');
        var classname;
        var onInitial = Ext.emptyFn();

        var text = record.get('text');
        switch(text) {
            case '故障受信监控':
                classname = 'Service.branch_FaultMonitor';
                onShow = function() {
                    Ext.getCmp('service_Branch_FaultMonitorionMap_Data').getStore().loadDat(
                        function() {},
                        function() {},
                        'all'
                    );
                };
                break;

            case '遥监故障发报':
                classname = 'Online.faultPublish';
                onShow = function() {
                    Ext.getCmp('online_FaultPublish_List').getStore().loadDat(
                        function() {},
                        function() {}
                    );
                };
                break;
        }

        subView.show({classname:classname, parent:parent, onInitial:onInitial, onShow:onShow});
        remote.send(dataview, index);
    },

    onOnline_ListNav2ItemTap: function(dataview, index, target, record, e, eOpts) {
        // 工作模式2 - 菜单
        var parent = Ext.getCmp('Online_subNav2');
        var classname;
        var onInitial = Ext.emptyFn();
        var areaCode = remote.getArea().code;

        var text = record.get('text');
        switch(text) {
            case '全国地图':
                classname = 'Service.chinaMap';
                onInitial = function() {
                    Ext.getCmp('service_chinaMap_PnlOther').hide();
                    Ext.getCmp('service_ChinaMap_DataCity').getStore().loadDat(
                        function() {},
                        function() {},
                        null
                    );
                };
                break;

            case '行业新闻':
                if(areaCode==='all') {
                    areaCode = '';
                }
                classname = 'Service.news';
                onInitial = function() {
                    Ext.getCmp('service_News_DataNews').getStore().loadDat(
                        function() {},
                        function() {},
                        areaCode
                    );
                };
                break;

            case '故障受信监控':
                classname = 'Service.branch_FaultMonitor';
                onInitial = function() {
                    Ext.getCmp('service_Branch_FaultMonitorionMap_Data').getStore().loadDat(
                        function() {},
                        function() {},
                        areaCode
                    );
                };
                break;

            case '保养作业':
                classname = 'Service.branch_Maintain';
                onInitial = function() {
                    Ext.getCmp('Service_branch_Maintain_Data').getStore().loadDat(
                        function() {},
                        function() {},
                        areaCode
                    );
                };
                break;

            case '故障演示':
                classname = 'Service.demo';
                break;

        }

        subView.show({classname:classname, parent:parent, onInitial:onInitial});
        remote.send(dataview, index);
    },

    onOnline_BtnOnline1Tap: function(button, e, eOpts) {
        // 转到工作模式2
        var parent = Ext.getCmp('remote_Main');
        subView.show({
            classname: 'Online.subNav2',
            parent: parent,
            onShow: function() {
                remote.send(button);
            }
        });
    },

    onOnline_BtnOnline2Tap: function(button, e, eOpts) {
        // 转到工作模式1
        var parent = Ext.getCmp('remote_Main');
        subView.show({
            classname: 'Online.subNav1',
            parent: parent,
            onShow: function() {
                remote.send(button);
            }
        });
    },

    /* 遥监发报过滤 - 所有 */
    onOnline_FaultPublish_BtnAllTap: function(button, e, eOpts) {
        Ext.getCmp('online_FaultPublish_List').getStore().filteDat('');
    },

    /* 遥监发报过滤 - 困人 */
    onOnline_FaultPublish_BtnTrapTap: function(button, e, eOpts) {
        Ext.getCmp('online_FaultPublish_List').getStore().filteDat('trap');
    },

    /* 遥监发报 - 选中记录 - 进入遥监 */
    onOnline_FaultPublish_ListItemTap: function(dataview, index, target, record, e, eOpts) {
        var elevatorno   = record.get('elevatorNo');
        var elevatortype = record.get('elevatorType') || '0';
        HelcRemote.app.getController('ServiceElevatorController').doOpenElevatorDetail(elevatorno, elevatortype);
    },

    onOnline_subNav2Initialize: function(component, eOpts) {
        var mode = remote.getScreenMode();
        if(mode==='1') {
            Ext.getCmp('Online_ListNav2').setData([
                { text: '全国地图' },
                { text: '行业新闻' },
                { text: '故障演示' },
                { text: '故障受信监控' },
                { text: '保养作业' },
            ]);
        } else {
            // 大屏无保养作业
            Ext.getCmp('Online_ListNav2').setData([
                { text: '全国地图' },
                { text: '行业新闻' },
                { text: '故障演示' },
                { text: '故障受信监控' },
            ]);
        }

    }

});