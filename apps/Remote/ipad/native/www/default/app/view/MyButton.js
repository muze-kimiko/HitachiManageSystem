
/* JavaScript content from app/view/MyButton.js in folder common */
/*
 * File: app/view/MyButton.js
 *
 * This file was generated by Sencha Architect
 * http://www.sencha.com/products/architect/
 *
 * This file requires use of the Sencha Touch 2.4.x library, under independent license.
 * License of Sencha Architect does not include license for Sencha Touch 2.4.x. For more
 * details see http://www.sencha.com/license or contact license@sencha.com.
 *
 * This file will be auto-generated each and everytime you save your project.
 *
 * Do NOT hand edit this file.
 */

Ext.define('HelcRemote.view.MyButton', {
    extend: 'Ext.Button',
    alias: 'widget.mybutton',

    config: {
        deviceType: 'dummy',
        isOn: false,
        cls: 'x-device-off',
        style: 'width:100%',
        text: '按钮',
        relativeId: [
            
        ],
        listeners: [
            {
                fn: 'onButtonTap',
                event: 'tap'
            }
        ]
    },

    onButtonTap: function(button, e, eOpts) {
        var me = this;
        switch(me.getDeviceType()) {
            case 'AC':
                var code = this.getControlCode();
                acRemote.send(code, function(ret) {
                    if(ret.status.code==='200') {
                        me.toggle();
                    }
                });
                break;

            case 'DEVICE':
                var id = this.getId();

                deviceRemote.send(id);
                deviceRemote.setOn(id);
                break;
        }

    },

    toggle: function() {
        this.config.isOn = !this.config.isOn;
        if(this.config.isOn) {
            this.setOn();
        } else {
            this.setOff();
        }
    },

    getControlCode: function() {
        var code = this.getId();
        if(this.getDeviceType()==='AC') {
            if(this.config.isOn) {
                code = code + 'OF';
            } else {
                code = code + 'ON';
            }
        }

        return code;
    },

    setOn: function() {
        this.setCls('x-device-on');
        this.config.isOn = true;
    },

    setOff: function() {
        this.setCls('x-device-off');
        this.config.isOn = false;
    },

    getDeviceType: function() {
        return this.config.deviceType.toUpperCase();
    },

    getRelativeId: function() {
        return this.config.relativeId;
    }

});